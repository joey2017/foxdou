<?php
namespace App\Admin\Model;

use App\Common\Model\AutoGenerated\scheduled_jobs;
use SimpleRecord\DateTime;

class CronJob extends scheduled_jobs {

    static $table_name = 'yzb_scheduled_jobs';

    const STATUS_PENDING   = 'PENDING';
    const STATUS_RUNNING   = 'RUNNING';
    const STATUS_FINISHED  = 'FINISHED';
    const STATUS_CANCELLED = 'CANCELLED';
    const STATUS_FAILED    = 'FAILED';

    const STATUSES = [
        self::STATUS_PENDING   => '等待执行',
        self::STATUS_RUNNING   => '执行中',
        self::STATUS_FINISHED  => '执行完毕',
        self::STATUS_CANCELLED => '已撤销',
        self::STATUS_FAILED    => '执行失败',
    ];

    public function __toString() {
        /**
         * @var DateTime $date
         */
        $date = $this->scheduled_at;
        return sprintf("[%s(%s:%d@%s)]", $this->name, $this->type, $this->id, $date->format('Y-m-d H:i:s'));
    }
}